Initializing...
Done
Traceback (most recent call last):
  File "run_model.py", line 9, in <module>
    from model import rot_um_cnn
  File "/global/cscratch1/sd/roseyu/Eliza/Rot-UM/model.py", line 182, in <module>
    train_mse.append(train_epoch(train_loader, model, optimizer, loss_fun))
  File "/global/cscratch1/sd/roseyu/Eliza/Rot-UM/train.py", line 50, in train_epoch
    im = model(xx)
  File "/global/homes/r/roseyu/.conda/envs/myenv/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/global/cscratch1/sd/roseyu/Eliza/Rot-UM/model.py", line 139, in forward
    return self.layers(xx)
  File "/global/homes/r/roseyu/.conda/envs/myenv/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/global/homes/r/roseyu/.conda/envs/myenv/lib/python3.6/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/global/homes/r/roseyu/.conda/envs/myenv/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/global/cscratch1/sd/roseyu/Eliza/Rot-UM/model.py", line 94, in forward
    kernel = self.get_kernel(self.params, self.basis)
  File "/global/cscratch1/sd/roseyu/Eliza/Rot-UM/model.py", line 61, in get_kernel
    kernel = torch.einsum("abcd, cdefgh -> abefgh",  (self.params, self.basis.to(device)))
  File "/global/homes/r/roseyu/.conda/envs/myenv/lib/python3.6/site-packages/torch/functional.py", line 241, in einsum
    return torch._C._VariableFunctions.einsum(equation, operands)
RuntimeError: Expected object of device type cuda but got device type cpu for argument #1 'self' in call to _th_bmm
srun: error: cgpu09: task 0: Exited with exit code 1
srun: Terminating job step 600651.0
